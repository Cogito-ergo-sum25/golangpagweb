{{template "base" .}}
{{define "content"}}
<div class="container mt-4">
    <h2><i class="fas fa-edit me-2"></i> Editar Aclaración</h2>
    
    {{$a := .Data.Aclaracion}} <form method="POST" action="/editar-aclaracion/{{$a.IDAclaracionLicitacion}}" novalidate>
        <input type="hidden" name="csrf_token" value="{{.CSRFToken}}">
        <input type="hidden" name="id_licitacion" value="{{$a.IDLicitacion}}"> <div class="card shadow">
            <div class="card-body">
                <div class="mb-3">
                    <label for="id_partida" class="form-label">Partida</label>
                    <select class="form-select" id="id_partida" name="id_partida">
                        <option value="">Sin partida asociada</option>
                        {{range .Data.Partidas}}
                        <option value="{{.IDPartida}}" {{if eq .IDPartida $a.IDPartida}}selected{{end}}>
                            #{{.NumPartidaConvocatoria}} - {{.NombreDescripcion}}
                        </option>
                        {{end}}
                    </select>
                </div>

                <div class="mb-3">
                    <label for="id_empresa" class="form-label">Empresa *</label>
                    <select class="form-select" id="id_empresa" name="id_empresa" required>
                        {{range .Data.Empresas}}
                        <option value="{{.IDEmpresa}}" {{if eq .IDEmpresa $a.IDEmpresa}}selected{{end}}>
                            {{.Nombre}}
                        </option>
                        {{end}}
                    </select>
                </div>

                <div class="mb-3">
                    <label for="pregunta" class="form-label">Pregunta *</label>
                    <textarea class="form-control" name="pregunta" required rows="3">{{$a.Pregunta}}</textarea>
                </div>

                <div class="mb-3">
                    <label for="observaciones" class="form-label">Observaciones</label>
                    <textarea class="form-control" name="observaciones" rows="2">{{$a.Observaciones}}</textarea>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="ficha_tecnica_id" class="form-label">Ficha Técnica ID</label>
                        <input type="text" class="form-control" name="ficha_tecnica_id" value="{{$a.FichaTecnicaID}}">
                    </div>

                    <div class="col-md-6 mb-3">
                        <label for="id_puntos_tecnicos_modif" class="form-label">Puntos Técnicos Modif. ID</label>
                        <input type="number" class="form-control" name="id_puntos_tecnicos_modif" value="{{$a.IDPuntosTecnicosModif}}">
                    </div> 
                </div>

                <div class="mb-3">
                    <label class="form-label">Tipo de Pregunta (Automático)</label>
                    <input type="text" class="form-control" 
                        value="{{if $a.PreguntaTecnica}}Técnica{{else}}Legal / Administrativa{{end}}" 
                        readonly disabled>
                    <div class="form-text">Este valor se calcula automáticamente si la aclaración está ligada a una partida.</div>
                </div>

                <div class="text-end border-top pt-3 mt-4">
                    <a href="/aclaraciones-licitacion/{{$a.IDLicitacion}}" class="btn btn-secondary">Cancelar</a>
                    <button type="submit" class="btn verde">Guardar Cambios</button>
                </div>
            </div>
        </div>
    </form>
</div>
{{end}}